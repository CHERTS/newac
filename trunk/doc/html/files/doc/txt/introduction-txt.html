<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>Introduction - NewAC</title><link rel="stylesheet" type="text/css" href="../../../styles/main.css"><script language=JavaScript src="../../../javascript/main.js"></script><script language=JavaScript src="../../../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 12-07-2007 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Introduction"></a>Introduction</h1><div class=CBody><p>An introduction to NewAC, Delphi components for manipulating audio data.</p><h4 class=CHeading>Author</h4><p>Andrei Borovsky, <a href="#" onClick="location.href='mai' + 'lto:' + 'a' + 'nb' + '@' + 'symmetr' + 'ica.net'; return false;" class=LEMail>a<span style="display: none">.nosp@m.</span>nb<span>@</span>symmetr<span style="display: none">.nosp@m.</span>ica.net</a></p><h4 class=CHeading>Contributors</h4><p>Several people have made contributions to the NewAC code.</p><ul><li>Lev Amelin: improved and extended TMP3Out component.</li><li>Thomas la Cour (<a href="http://www.top-house.dk/~nr161/delphi/" class=LURL target=_top>http://www.top-house.dk/~nr161/delphi/</a>): Monkey Audio input/output components.</li><li>Jan Henrik Ejme: adding ACM-playing support.</li><li>Thomas Grelle: improving CDRip support.</li><li>Jan Bartels (ATR Industrie-Elektronik GmbH &amp; Co.&nbsp; KG, Viersen, Germany): some useful corrections and suggestions.</li><li>Sergei Borisov: quite a few contributions, including TWVIn and TWVOut components.</li><li>Eriks Aleksans: many useful suggestions.</li><li>Wayne Thursby: preparing documentation and not breaking things (not entirely, at least)</li></ul><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#Introduction" >Introduction</a></td><td class=SDescription>An introduction to NewAC, Delphi components for manipulating audio data.</td></tr><tr class="SSection"><td class=SEntry><a href="#On_the_Web" >On the Web</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Project_Homepage" >Project Homepage</a></td><td class=SDescription>You can find the official homepage of NewAC at <a href="http://www.symmetrica.net/newac" class=LURL target=_top>http://www.symmetrica.net/newac</a>.</td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Project_Discussion" >Project Discussion</a></td><td class=SDescription>Discussion and support can be found on the Google Group newac-users at <a href="http://groups.google.com/group/newac-users" class=LURL target=_top>http://groups.google.com/group/newac-users</a>.</td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Project_Source" >Project Source</a></td><td class=SDescription>The source code for NewAC is now hosted on Google Code <a href="http://code.google.com/p/newac/" class=LURL target=_top>http://code.google.com/p/newac/</a>.</td></tr><tr class="SSection"><td class=SEntry><a href="#Version_History" >Version History</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#NewAC_1.3.2" >NewAC 1.3.2</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#NewAC_v1.3.1" >NewAC v1.3.1</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#NewAC_v1.3" >NewAC v1.3</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#NewAC_v1.2" >NewAC v1.2</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#NewAC_v1.1" >NewAC v1.1</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#NewAC_v1.0.1" >NewAC v1.0.1</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#NewAC_v1.0" >NewAC v1.0</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#ACS_v2.3" >ACS v2.3</a></td><td class=SDescription></td></tr><tr class="SSection"><td class=SEntry><a href="#Introduction_to_NewAC_Programming" >Introduction to NewAC Programming</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Basic_Operation" >Basic Operation</a></td><td class=SDescription>The New Audio Components package is a set of components designed to handle different sound processing tasks, such as reading and storing data in different audio formats, working with sound hardware, audio streams mixing and so on.</td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Ripping_a_CD_to_OGG" >Ripping a CD to OGG</a></td><td class=SDescription>Suppose you want your application to convert data from audio CD tracks to Ogg Vorbis audio compression format. </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Converting_Stereo_to_Mono" >Converting Stereo to Mono</a></td><td class=SDescription>To get stereo audio data from a *.wav file, convert it to mono and save to another *.wav file, we will need an instance of the TWaveIn component. </td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Using_Streams" >Using Streams</a></td><td class=SDescription>Almost all NewAC components that read data from audio files or store data in audio file format can work with both disk files and memory streams (currently only TMACIn and TMACOut components do not support general streams). </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Stopping_and_Pausing" >Stopping and Pausing</a></td><td class=SDescription>You can stop a playing chain by calling an output component&rsquo;s Stop method. </td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Terminating_the_Playback" >Terminating the Playback</a></td><td class=SDescription>You can call the output component’s Stop method to terminate an ongoing playback at any time, but because of the multithreaded nature of NewAC the playback doesn&rsquo;t stop at once when requested. </td></tr><tr class="SSection"><td class=SEntry><a href="#Chaining_Audio_Tasks" >Chaining Audio Tasks</a></td><td class=SDescription>In some cases you may want to start the next audio task automatically right after the previous task has been finished. </td></tr><tr class="SSection"><td class=SEntry><a href="#Editing_Sound" >Editing Sound</a></td><td class=SDescription>Several sound-editing operations can be performed with NewAC. </td></tr><tr class="SSection"><td class=SEntry><a href="#Handling_Thread_Exceptions" >Handling Thread Exceptions</a></td><td class=SDescription>NewAC does its best to recover from any error that might occur. </td></tr><tr class="SSection"><td class=SEntry><a href="#Input_Switching" >Input Switching</a></td><td class=SDescription>Most of the output components allow assigning new input on the fly (i.e. </td></tr><tr class="SSection"><td class=SEntry><a href="#Avoiding_Common_Errors" >Avoiding Common Errors</a></td><td class=SDescription>This section explains how to avoid some errors that are most often encountered by the programmers beginning to use NewAC.</td></tr><tr class="SSection"><td class=SEntry><a href="#Legacy_Components" >Legacy Components</a></td><td class=SDescription>Some NewAC components are now considered legacy. </td></tr><tr class="SSection"><td class=SEntry><a href="#The_Third-party_Libraries" >The Third-party Libraries</a></td><td class=SDescription>Some of NewAC components require certain shared libraries, which are not included in the package but are publicly available and may be found on many sites both in source and binary forms. </td></tr><tr class="SSection"><td class=SEntry><a href="#Installation" >Installation</a></td><td class=SDescription>Since NewAc is an ordinary Delphi package its installation procedure should be straightforward for most of the Delphi users.</td></tr><tr class="SSection"><td class=SEntry><a href="#Writing_Your_Own_Components" >Writing Your Own Components</a></td><td class=SDescription>Eventually you may want to extend NewAC with your own components. </td></tr><tr class="SSection"><td class=SEntry><a href="#Licenses" >Licenses</a></td><td class=SDescription>The NewAC code itself is distributed free of charge, under a simple license that allows an unrestricted use (both non-commercial and commercial). </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="On_the_Web"></a>On the Web</h2><div class=CBody><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SGeneric"><td class=SEntry><a href="#Project_Homepage" >Project Homepage</a></td><td class=SDescription>You can find the official homepage of NewAC at <a href="http://www.symmetrica.net/newac" class=LURL target=_top>http://www.symmetrica.net/newac</a>.</td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Project_Discussion" >Project Discussion</a></td><td class=SDescription>Discussion and support can be found on the Google Group newac-users at <a href="http://groups.google.com/group/newac-users" class=LURL target=_top>http://groups.google.com/group/newac-users</a>.</td></tr><tr class="SGeneric"><td class=SEntry><a href="#Project_Source" >Project Source</a></td><td class=SDescription>The source code for NewAC is now hosted on Google Code <a href="http://code.google.com/p/newac/" class=LURL target=_top>http://code.google.com/p/newac/</a>.</td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Project_Homepage"></a>Project Homepage</h3><div class=CBody><p>You can find the official homepage of NewAC at <a href="http://www.symmetrica.net/newac" class=LURL target=_top>http://www.symmetrica.net/newac</a>.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Project_Discussion"></a>Project Discussion</h3><div class=CBody><p>Discussion and support can be found on the Google Group newac-users at <a href="http://groups.google.com/group/newac-users" class=LURL target=_top>http://groups.google.com/group/newac-users</a>.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Project_Source"></a>Project Source</h3><div class=CBody><p>The source code for NewAC is now hosted on Google Code <a href="http://code.google.com/p/newac/" class=LURL target=_top>http://code.google.com/p/newac/</a>.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Version_History"></a>Version History</h2><div class=CBody><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SGeneric"><td class=SEntry><a href="#NewAC_1.3.2" >NewAC 1.3.2</a></td><td class=SDescription></td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#NewAC_v1.3.1" >NewAC v1.3.1</a></td><td class=SDescription></td></tr><tr class="SGeneric"><td class=SEntry><a href="#NewAC_v1.3" >NewAC v1.3</a></td><td class=SDescription></td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#NewAC_v1.2" >NewAC v1.2</a></td><td class=SDescription></td></tr><tr class="SGeneric"><td class=SEntry><a href="#NewAC_v1.1" >NewAC v1.1</a></td><td class=SDescription></td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#NewAC_v1.0.1" >NewAC v1.0.1</a></td><td class=SDescription></td></tr><tr class="SGeneric"><td class=SEntry><a href="#NewAC_v1.0" >NewAC v1.0</a></td><td class=SDescription></td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#ACS_v2.3" >ACS v2.3</a></td><td class=SDescription></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_1.3.2"></a>NewAC 1.3.2</h3><div class=CBody><ul><li>Improved WMA encoder</li><li>Object Model has changed: SuspendWhenIdle property and WaitForStop method are now obsolete.</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.3.1"></a>NewAC v1.3.1</h3><div class=CBody><ul><li>MP3 decoding is now done with Windows decoder (additional DLL (mpadec.dll) no longer needed)</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.3"></a>NewAC v1.3</h3><div class=CBody><ul><li>Windows Media files input support (TWMIn component), Windows Media Audio (wma) files output support (TWMAOut component).</li><li>Event handling improved</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.2"></a>NewAC v1.2</h3><div class=CBody><ul><li>WavPack format support (TWVIn, TWVOut components).</li><li>24-bit sound support.</li><li>Unicode file names support (via the WideFileName property).</li><li>Large (larger than 2 GB) files support.</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.1"></a>NewAC v1.1</h3><div class=CBody><ul><li>Base class interfaces is changed to make data flow more efficient.</li><li>FLAC and Monkey&rsquo;s Audio codecs are updated.</li><li>New TAudioConverter and TResampler components are added.</li><li>New MP3 decoder support is added to make MP3 input seekable.</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.0.1"></a>NewAC v1.0.1</h3><div class=CBody><ul><li>Ogg Vorbis bugs are fixed.</li><li>DirectSound API is implemented in Delphi, so there is no more need in dswrapper DLL.</li><li>Base classes are renamed from TACS* to TAu*.</li><li>Some minor bugs are fixed.</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="NewAC_v1.0"></a>NewAC v1.0</h3><div class=CBody><ul><li>Some bugs are fixed.</li><li>TMP3In component is added for mp3 playback.</li><li>TCDPlayer can now work with several drives.</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="ACS_v2.3"></a>ACS v2.3</h3><div class=CBody><ul><li>Changes in the object model: Event and thread handling improved.</li><li>DirectX input/output has been added (TDXAudiIn and TDXAudiOut components).</li><li>TMP3Out component has been improved.</li></ul></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Introduction_to_NewAC_Programming"></a>Introduction to NewAC Programming</h2><div class=CBody><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SGeneric"><td class=SEntry><a href="#Basic_Operation" >Basic Operation</a></td><td class=SDescription>The New Audio Components package is a set of components designed to handle different sound processing tasks, such as reading and storing data in different audio formats, working with sound hardware, audio streams mixing and so on.</td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Ripping_a_CD_to_OGG" >Ripping a CD to OGG</a></td><td class=SDescription>Suppose you want your application to convert data from audio CD tracks to Ogg Vorbis audio compression format. </td></tr><tr class="SGeneric"><td class=SEntry><a href="#Converting_Stereo_to_Mono" >Converting Stereo to Mono</a></td><td class=SDescription>To get stereo audio data from a *.wav file, convert it to mono and save to another *.wav file, we will need an instance of the TWaveIn component. </td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Using_Streams" >Using Streams</a></td><td class=SDescription>Almost all NewAC components that read data from audio files or store data in audio file format can work with both disk files and memory streams (currently only TMACIn and TMACOut components do not support general streams). </td></tr><tr class="SGeneric"><td class=SEntry><a href="#Stopping_and_Pausing" >Stopping and Pausing</a></td><td class=SDescription>You can stop a playing chain by calling an output component&rsquo;s Stop method. </td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Terminating_the_Playback" >Terminating the Playback</a></td><td class=SDescription>You can call the output component’s Stop method to terminate an ongoing playback at any time, but because of the multithreaded nature of NewAC the playback doesn&rsquo;t stop at once when requested. </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Basic_Operation"></a>Basic Operation</h3><div class=CBody><p>The New Audio Components package is a set of components designed to handle different sound processing tasks, such as reading and storing data in different audio formats, working with sound hardware, audio streams mixing and so on.</p><p>Most of the components in the New Audio Components package belong to one of three categories: input components, output components, converter components.&nbsp; There are also two components that do not fit into this scheme.&nbsp; These are TCDPlayer component and TMixer component.</p><p>The input components acquire audio input from some source (device, disk file, etc.) and convert it into a digital audio stream which is the internal audio representation in NewAC.&nbsp; The output components take in the digital audio produced by input components and send it to some audio output device or store it on disk in a specified audio file format.&nbsp; Converter components perform different operations on audio streams.&nbsp; These components take in a digital audio stream and output a stream which is modified according to the function of the component.&nbsp; The following diagram illustrates the flow of audio data in the NewAC processing chain.</p><img src="../images/diagram.png" width="143" height="223"><p>All components are linked via their Input properties.&nbsp; Arrows show connections between components (from WaveOut1 to AudioIn1).&nbsp; Audio data flows through the chain in the opposite direction, from AudioIn1 to WaveOut1.&nbsp; In this example we read audio data from the sound card input component AudioIn1 (input component), pass it through the RateConverter1 component (converter component) and store in a *.wav file via WaveOut1 component (output component).</p><p>The converter component is not a necessary element in this chain.&nbsp; In many cases you will just connect input and output components together to convert data from one format to the other or to perform I/O with some particular device.&nbsp; As you can see NewAC isn&rsquo;t just a collection of components implementing interfaces to some hardware or file formats.&nbsp; It is rather a set of building blocks with which you can construct a complete sound-processing application.</p><p>The driving force of this sound processing chain is an output component.&nbsp; Output components use internal thread objects that call data-retrieving functions of the input/converter components attached to the output component.&nbsp; Note that NewAC provides you with several ways to set the amount of CPU time consumed by these threads: TheradPriority, Delay, and SuspendWhenIdle properties.&nbsp; You can use this features to set the best performance/CPU usage ratio in your NewAC applications.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Ripping_a_CD_to_OGG"></a>Ripping a CD to OGG</h3><div class=CBody><p>Suppose you want your application to convert data from audio CD tracks to Ogg Vorbis audio compression format.&nbsp; First, you put into your form a TCDIn input component that reads data from CD tracks (don&rsquo;t confuse this component with TCDPlayer component which is designed to play CD tracks).&nbsp; Now you need an output component, and in our case it is VorbisOut.&nbsp; In order to chain two components together you have to assign an instance of the TCDIn component to the VorbisOut&rsquo;s Input property.</p><blockquote><pre>VorbisOut1.Input := CDIn1;</pre></blockquote><p>Now set the CD track you want to be converted.</p><blockquote><pre>CDIn1.StartTrack := 1;
CDIn1.EndTrack := 1;</pre></blockquote><p>This tells the component to read only one track (the first track on the CD).</p><p>Now you have to set up a file name for an output file.</p><blockquote><pre>VorbisOut1.FileName := 'Track1.ogg';</pre></blockquote><p>And desired compression ratio.</p><blockquote><pre>VorbisOut1.Compression := 0.1;</pre></blockquote><p>Believe it or not, you have now set up everything for the data conversion.&nbsp; In order to perform the conversion, call Run method is used.</p><blockquote><pre>VorbisOut1.Run;</pre></blockquote><p>The actual compression process runs in its own thread, while your main thread can do something else.&nbsp; You can control how conversion goes on by checking VorbisOut1&rsquo;s Progress property.&nbsp; When the conversion is finished, the VorbisOut1.OnDone property will be called.</p><p>If you disable some application&rsquo;s controls while NewAC components perform their action and enable them back in the OnDone event handler (like it is done in most of the demos), make sure you disable the controls before calling the Run method.&nbsp; Otherwise these controls may be not automatically re-enabled if an error occurs during NewAC operation.</p><p>You get access to an input component&rsquo;s data directly in a non-threaded way.&nbsp; The following example shows how data can be obtained from an audio CD with the TCDIn component.</p><blockquote><pre>var
  Len, DataSize : Integer;
  Data : Pointer;
begin
  ...
  CDIn1.StartTrack := 1;
  CDIn1.EndTrack := 1;
  CDIn1.Init;
  Len := CDIn1.CopyData(Data, DataSize);
  while Len &lt;&gt; 0 do
  begin
    // Process CD data
    Len := CDIn1.CopyData(Data, DataSize);
  end;
  CDIn1.Flush;
  ...
end;</pre></blockquote></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Converting_Stereo_to_Mono"></a>Converting Stereo to Mono</h3><div class=CBody><p>To get stereo audio data from a *.wav file, convert it to mono and save to another *.wav file, we will need an instance of the TWaveIn component.&nbsp; It reads data from a *.wav file, an instance of the TMSConverter component then converts the stereo stream to mono, and an instance of the TWaveOut component that writes data to a *.wav file.&nbsp; Now we chain these three components.</p><blockquote><pre>WaveIn1.FileName := 'input.wav';
MSConverter1.Input := WaveIn1;
WaveOut1.Input := MSConverter1;
WaveOut1.FileName := 'output.wav';
WaveOut1.Run;</pre></blockquote><p>Converter components take input from input components or from other converters and output data to output components or other converters.&nbsp; It is possible to chain any number of converters this way.&nbsp; There is a special converter in NewAC called AudioMixer.&nbsp; This component takes in two audio streams and mixes them into a single output stream.&nbsp; In the new version of NewAC AudioMixer can also concatenate to incoming audio streams, i.e. make one stream where two input streams go consecutively.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Using_Streams"></a>Using Streams</h3><div class=CBody><p>Almost all NewAC components that read data from audio files or store data in audio file format can work with both disk files and memory streams (currently only TMACIn and TMACOut components do not support general streams).&nbsp; You can use FileName property to specify the name of the file on disk (or the WideFileName property if the file name is in Unicode) or the Stream property to assign some other type of stream (including a memory stream TMemoryStream) to an input or an output component.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Stopping_and_Pausing"></a>Stopping and Pausing</h3><div class=CBody><p>You can stop a playing chain by calling an output component&rsquo;s Stop method.&nbsp; If you want to pause playback, call the output component&rsquo;s Pause method, and call Resume to resume the paused playback.&nbsp; Input components that read data from disc files and memory streams allow seeking.&nbsp; Use an input component&rsquo;s Seek method to set the current input position (the position is measured from the beginning of data in frames, not in bytes).</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Terminating_the_Playback"></a>Terminating the Playback</h3><div class=CBody><p>You can call the output component’s Stop method to terminate an ongoing playback at any time, but because of the multithreaded nature of NewAC the playback doesn&rsquo;t stop at once when requested.&nbsp; There are two modes of behavior when you call a Stop method.&nbsp; The first mode is asynchronous.&nbsp; In this mode the called Stop returns at once (may be before the output component is stopped).&nbsp; When the output components is actually stopped your application gets an OnDone event.&nbsp; In this mode you can use OnDone event handler to get notified when your App’s audio chain finishes playing.&nbsp; Sometimes you don&rsquo;t want to wait for OnDone event.&nbsp; For example it is a good practice to stop any current output in the Application’s Form OnClose Event.&nbsp; In that case you can call Stop in synchronous mode.&nbsp; In this mode Stop blocks the calling thread until the output is actually stopped.&nbsp; No OnDone event is raised in this mode..&nbsp; To call Stop in asynchronous mode pass True as a value of its only argument (this is the default value, so calling Stop without an argument stops asynchronously).&nbsp; To make synchronous Stop call pass the False value as the method&rsquo;s argument.&nbsp; There are two ways of calling Stop.</p><blockquote><pre>WaveOut1.Stop;  // Asynchronous call
...   // Wait for an OnDone event to know when the output is done</pre></blockquote><p>or</p><blockquote><pre>WaveOut1.Stop(False); // Synchronous call. When it returns the output is actually done</pre></blockquote></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Chaining_Audio_Tasks"></a>Chaining Audio Tasks</h2><div class=CBody><p>In some cases you may want to start the next audio task automatically right after the previous task has been finished.&nbsp; Suppose you build an audio player with a kind of playlist.&nbsp; You want the files in the playlist to be played one after another.&nbsp; When the current file playback or other output operation is finished output component generates OnDone event indicating it has finished current output operation.&nbsp; Starting from the NewAC version 1.0 you can set new input source component (or reset current input properties) from OnDone event handler.&nbsp; See AudioPlayer demo program for an example.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Editing_Sound"></a>Editing Sound</h2><div class=CBody><p>Several sound-editing operations can be performed with NewAC.&nbsp; Converter components allow you to change the number of channels, bits per sample, and the sample rate of an audio stream.&nbsp; With the TAudioMixer component you can mix together two audio streams, selecting volume level values for each stream, and concatenate two streams into a single stream.&nbsp; See the AudioMixer demo for streams mixing and concatenation example.</p><p>TWaveOut and TVorbisOut components allow you to append audio data to the already existing files.&nbsp; Set the component&rsquo;s FileMode property to foAppend to append data to an existing file rather than rewriting it.</p><p>All input components that descend from TAuFileIn allow you to specify StartSample and EndSample properties.&nbsp; If you set these properties&rsquo; values, the actual data reading will start from the StartSample and will stop at EndSample value (the total number of samples in the input stream is returned via TotalSamples property, and since it is read from the file, you should check the Valid property value before reading TotalSamples).&nbsp; This way you can select a fragment of an input audio file, rather than a whole file, for further processing.&nbsp; AudioCutter demo shows how to play back and save selected fragments of audio files.&nbsp; The StartSample and EndSample properties allow to select audio file fragments with the maximum possible precision.&nbsp; If you don&rsquo;t need that precision you can use SetStartTime and SetEndTime methods that specify start and end time for the selection in minutes:seconds format.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Handling_Thread_Exceptions"></a>Handling Thread Exceptions</h2><div class=CBody><p>NewAC does its best to recover from any error that might occur.&nbsp; If an exception is raised within NewAC after you have called an output component&rsquo;s Run method it is not propagated.&nbsp; The OnThreadException event is generated instead and the exception&rsquo;s text is stored in the output component&rsquo;s ExceptionMessage property.&nbsp; After that an OnDone event is generated as usual.&nbsp; You can determine if an error has happened during the NewAC operation by assigning a handler to the OnThreadException event or by checking the ExceptionMessage value in an OnDone event handler (it should be an empty string if no error took place).&nbsp; See CDRipper and Wave2Ogg-2 demos for how error-handling is done.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Input_Switching"></a>Input Switching</h2><div class=CBody><p>Most of the output components allow assigning new input on the fly (i.e. while the component is doing playback).&nbsp; It is important to remember that when changing input on the fly, new input audio stream parameters must be the same as the old ones.&nbsp; Note that TAudioProcessor Component doesn&rsquo;t allow modifying Input property while it is playing.&nbsp; InputList component allows modifying all input items at anytime except the item, currently being played.&nbsp; You can switch to other InputList&rsquo;s item on the fly by changing the components CurrentInput property.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Avoiding_Common_Errors"></a>Avoiding Common Errors</h2><div class=CBody><p>This section explains how to avoid some errors that are most often encountered by the programmers beginning to use NewAC.</p><ul><li>Never call an output component&rsquo;s Run method if the component is busy.&nbsp; You can check if it is by inspecting the value of the Status property.&nbsp; Output component goes to the busy state after its Run method is called.&nbsp; When component becomes idle, its OnDone event is triggered.</li><li>With the TCDIn component it is a good practice to check if the right kind of media is in the drive before calling any disc-concerning method.&nbsp; You can check the CD in the drive by means of DiscInfo and Status properties.</li><li>When using file input components always check if the assigned file is valid with Valid property before reading any file description properties or calling Run method.</li><li>Some of NewAC components require external DLLs.&nbsp; When you start a NewAC application and it cannot find a required DLL it shows a message &ldquo;foobar.dll could not be found&rdquo;... but not under Vista.&nbsp; Vista hides this message (just like many other important technical messages) from a user and tells you instead that your &ldquo;application suddenly stopped working&rdquo;.&nbsp; This may give you a false impression that the NewAC application is screwed up under Vista.&nbsp; That’s not so.&nbsp; If you get this &ldquo;the application suddenly stopped working&rdquo; dialog right when the app starts, check, first of all, if all the required DLLs are accessible to the application.&nbsp; Keep in mind that all the demos provided with NewAC work under Vista (at least under 32-bit version).</li></ul></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Legacy_Components"></a>Legacy Components</h2><div class=CBody><p>Some NewAC components are now considered legacy.&nbsp; They are kept for backward comparability and their development is stopped.&nbsp; For all these components there are analogous newer components that should be used instead.&nbsp; Here is the list of the current legacy components and their replacements.</p><ul><li>TAudioIn (should be replaced with TDXAudioIn in new programs).</li><li>TAudioOut (should be replaced with TDXAudioOut in new programs).</li><li>TRateConverter (should be replaced with TResampler in new programs).</li><li>TMSConverter (TMSConverter&rsquo;s functionality is duplicated in TAudioConverter, which additionally supports 24 bit sound conversion).</li></ul></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="The_Third-party_Libraries"></a>The Third-party Libraries</h2><div class=CBody><p>Some of NewAC components require certain shared libraries, which are not included in the package but are publicly available and may be found on many sites both in source and binary forms.&nbsp; You can download these libraries in binary form from the NewAC Site.&nbsp; If you want to compile yourself, below are the links to the libraries&rsquo; sources on the Net.</p><p>Libraries, require by some NewAC components in a precompiled binary form are available at <a href="http://symmetrica.net/uploads/newac/windlls.zip" class=LURL target=_top>http://symmetrica.net/uploads/newac/windlls.zip</a></p><p>It is important to note that since all libraries required by NewAC components are loaded dynamically at run-time, you can use NewAC as a whole without these libraries.&nbsp; Of course, those components requiring certain library will only work if the library is found.</p><ul><li>TVorbisIn and TVorbisOut components require Ogg Vorbis libraries (ogg.dll, vorbis.dll, vorbisenc.dll, vorbisfile.dll).&nbsp; See the additional note below.</li><li>TFLACIn and TFLACOut components depend on libFLAC.dll.&nbsp; You can find FLAC sources at <a href="http://flac.sourceforge.net" class=LURL target=_top>http://flac.sourceforge.net</a>.</li><li>Monkey Audio components require MacDLL.dll library.&nbsp; The Monkey Audio SDK is available at <a href="http://www.monkeysaudio.com" class=LURL target=_top>http://www.monkeysaudio.com</a>.</li><li>TCDIn component requires CDRip.dll library distributed under GPL (I use the variant of the library distributed with NeoAudio).</li><li>TResampler component requires the libsamplerate.dll library.&nbsp; You can get the sources at <a href="http://www.mega-nerd.com/SRC/win32.html" class=LURL target=_top>http://www.mega-nerd.com/SRC/win32.html</a>.</li><li>TMP3Out component requires lame_enc.dll (under Windows).&nbsp; Sources are available at <a href="http://lame.sourceforge.net" class=LURL target=_top>http://lame.sourceforge.net</a> Note: LAME is an encoder created for educational purposes only.&nbsp; It may be illegal to use LAME in your Country.</li></ul><h4 class=CHeading>Note on Ogg Vorbis libraries</h4><p>The original libraries available at <a href="http://www.xiph.org" class=LURL target=_top>http://www.xiph.org</a> are not fully compatible with Delphi.&nbsp; You should use alternative aoTuV Ogg Vorbis suite instead.&nbsp; You can get precompiled aoTuV Ogg Vorbis libraries from the NewAC site along with other libraries.&nbsp; The official aoTuV site is <a href="http://www.geocities.jp/aoyoume/aotuv/" class=LURL target=_top>http://www.geocities.jp/aoyoume/aotuv/</a>.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Installation"></a>Installation</h2><div class=CBody><p>Since NewAc is an ordinary Delphi package its installation procedure should be straightforward for most of the Delphi users.</p><p>If you have installed previous version of ACS or NewAC, uninstall it before installing the new version.&nbsp; Click Component-&gt;Install Packages menu item.&nbsp; In the opened dialog box select the Audio Components Suite package and click &ldquo;Remove&rdquo; button.&nbsp; Make sure to remove all the previous version files from the IDE search path.</p><p>To install New Audio Components package, first compile the package.&nbsp; Create or select directory where you want the components to be installed (you can use your Delphi lib directory).&nbsp; We will call this directory NewAC directory.&nbsp; Now go to the Source directory of the NewAC distribution, and copy all the files to the NewAC directory.&nbsp; Go to the NewAC directory, open NewAC.dpk file in your IDE.&nbsp; Press &ldquo;Compile&rdquo; button in the package manager window.&nbsp; Press Install button..&nbsp; After this the two new tabs: &ldquo;Audio I/O&rdquo; and &ldquo;Audio Processing&rdquo; will appear on the components palette.&nbsp; Unless you have selected your Delphi lib directory as NewAC directory, you will have to add the NewAC installation directory to the Delphi libraries search path.&nbsp; This can be done on the &ldquo;Library&rdquo; page of the &ldquo;Environment Options&rdquo; dialog box (Tools-&gt;Environment Options... menu item).</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Writing_Your_Own_Components"></a>Writing Your Own Components</h2><div class=CBody><p>Eventually you may want to extend NewAC with your own components.&nbsp; It will be great if you make these components available for the entire community (although you are not required to do so).&nbsp; How to write a new component for NewAC?&nbsp; You have the sources of all the components, and they all can be your guides.&nbsp; But most component&rsquo;s sources contain lots of component-specific stuff.&nbsp; It is not easy to tell from the first site, what is required, and what is arbitrary.&nbsp; Understanding this I have provided a special input/output components&rsquo; writer guide.&nbsp; You can find it in the file called cwguide.htm.&nbsp; Two demo components, TDemoWaveIn and TDemoWaveOut, are written specially for this tutorial.&nbsp; These two components are not the part of the main NewAC package, you can find them in the file ComponentsDemo.pas in the Demos\ComponentsDemo folder.&nbsp; These demo components handle simple input and output tasks, and the sources are extensively commented (unlike other components&rsquo; sources, I must admit).</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Licenses"></a>Licenses</h2><div class=CBody><p>The NewAC code itself is distributed free of charge, under a simple license that allows an unrestricted use (both non-commercial and commercial).&nbsp; See the license.txt for more detail.&nbsp; The third-party libraries required by different NewAC components are distributed under different licenses.</p><ul><li>The ogg.dll, vorbis.dll, vorbisfile.dll, and vorbisenc.dll libraries are distributed under the GPLv2.</li><li>The libFLAC.dll library is distributed under the GPLv2.</li><li>The libsamplerate.dll library is distributed under the GPLv2.</li><li>The MACDll.dll library is distributed under a custom license (<a href="http://www.monkeysaudio.com" class=LURL target=_top>http://www.monkeysaudio.com</a> for more details).</li><li>The CDRip.dll library is distributed under the GPLv2.</li></ul></div></div></div>

</div><!--Content-->


<div id=Footer>Copyright © 2002-2007 Andrei Borovsky. All rights reserved.&nbsp; &middot;&nbsp; Generated on January 21st, 2008&nbsp; &middot;&nbsp; <a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MTitle>NewAC<div class=MSubTitle>v1.4</div></div><div class=MEntry><div class=MLink><a href="http://www.symmetrica.net/newac">NewAC Project Page</a></div></div><div class=MEntry><div class=MLink><a href="http://groups.google.com/group/newac-users">NewAC Users Google Group</a></div></div><div class=MEntry><div class=MLink><a href="http://code.google.com/p/newac/">NewAC Source Google Code</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Docs</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MFile id=MSelected>Introduction</div></div><div class=MEntry><div class=MFile><a href="license-txt.html">License</a></div></div><div class=MEntry><div class=MFile><a href="cwguide-txt.html">Component Writer&rsquo;s Guide</a></div></div><div class=MEntry><div class=MFile><a href="about_documentation-txt.html">About the Documentation</a></div></div><div class=MEntry><div class=MFile><a href="tips_and_tricks-txt.html">Tips &amp; Tricks</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent2')">Demos</a><div class=MGroupContent id=MGroupContent2><div class=MEntry><div class=MFile><a href="../../demos/Tutorial/AudioProcessor/Main-pas.html">Audio Processor</a></div></div><div class=MEntry><div class=MFile><a href="../../demos/Tutorial/ComponentsDemo/ComponentsDemo-pas.html">Components Demo</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent7')">Units</a><div class=MGroupContent id=MGroupContent7><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent3')">I/O</a><div class=MGroupContent id=MGroupContent3><div class=MEntry><div class=MFile><a href="../../src/ACS_Audio-pas.html">ACS_Audio</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_AudioMix-pas.html">ACS_AudioMix</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_CDROM-pas.html">ACS_CDROM</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Classes-pas.html">ACS_Classes</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_DXAudio-pas.html">ACS_DXAudio</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_FLAC-pas.html">ACS_FLAC</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_LAME-pas.html">ACS_LAME</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_MAC-pas.html">ACS_MAC</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_smpeg-pas.html">ACS_SMPEG</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Tags-pas.html">ACS_Tags</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Vorbis-pas.html">ACS_Vorbis</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_WavPack-pas.html">ACS_WavPack</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Wave-pas.html">ACS_Wave</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_WinMedia-pas.html">ACS_WinMedia</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent4')">Conversion</a><div class=MGroupContent id=MGroupContent4><div class=MEntry><div class=MFile><a href="../../src/ACS_Converters-pas.html">ACS_Converters</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Filters-pas.html">ACS_Filters</a></div></div><div class=MEntry><div class=MFile><a href="../../src/AuSampleRate-pas.html">AuSampleRate</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent5')">Utility</a><div class=MGroupContent id=MGroupContent5><div class=MEntry><div class=MFile><a href="../../src/ACS_Misc-pas.html">ACS_Misc</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Procs-pas.html">ACS_Procs</a></div></div><div class=MEntry><div class=MFile><a href="../../src/acs_reg-pas.html">ACS_Reg</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ACS_Streams-pas.html">ACS_Streams</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent6')">Headers</a><div class=MGroupContent id=MGroupContent6><div class=MEntry><div class=MFile><a href="../../src/ACS_Types-pas.html">ACS_Types</a></div></div><div class=MEntry><div class=MFile><a href="../../src/CDRip-pas.html">CDRip</a></div></div><div class=MEntry><div class=MFile><a href="../../src/Codec-pas.html">Codec</a></div></div><div class=MEntry><div class=MFile><a href="../../src/DSWrapper-pas.html">DSWrapper</a></div></div><div class=MEntry><div class=MFile><a href="../../src/FLAC-pas.html">FLAC</a></div></div><div class=MEntry><div class=MFile><a href="../../src/MACDll-pas.html">MACDll.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/VorbisEnc-pas.html">VorbisEnc.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/VorbisFile-pas.html">VorbisFile.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/WavPackDLL-pas.html">WavPackDLL</a></div></div><div class=MEntry><div class=MFile><a href="../../src/WaveConverter-pas.html">WaveConverter.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/lame-pas.html">lame.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/libsamplerate-pas.html">libsamplerate.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/libwma1-pas.html">libwma1.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ogg-pas.html">ogg.pas</a></div></div><div class=MEntry><div class=MFile><a href="../../src/ovencode-pas.html">ovencode</a></div></div><div class=MEntry><div class=MFile><a href="../../src/wmfintf-pas.html">wmfintf.pas</a></div></div></div></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent8')">Index</a><div class=MGroupContent id=MGroupContent8><div class=MEntry><div class=MIndex><a href="../../../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Classes.html">Classes</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Properties.html">Properties</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Constants.html">Constants</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Types.html">Types</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Files.html">Files</a></div></div><div class=MEntry><div class=MIndex><a href="../../../index/Variables.html">Variables</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../../../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Classes">Classes</option><option value="Constants">Constants</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Properties">Properties</option><option value="Types">Types</option><option value="Variables">Variables</option></select></div><script language=JavaScript><!--
HideAllBut([1, 2, 7], 9);// --></script></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>